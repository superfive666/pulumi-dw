config:
  aws:profile: mpdw-dev
  aws:region: us-west-2
  data-platform:ec2:
    ami: ami-0d70546e43a941d70 # Canonical, Ubuntu, 22.04 LTS, amd64 jammy image build on 2022-06-09
    instanceType: r6i.2xlarge
    userData: > 
      # grant sudo access for tbladmin
      sudo adduser tbladmin
      sudo visudo
      sudo unlink /etc/localtime
      sudo ln -s /usr/share/zoneinfo/Asia/Singapore /etc/localtime

      # optional install zsh
      sh -c "$(curl -fsSL https://raw.githubusercontent.com/swwl1992/oh-my-zsh/master/tools/install.sh)"
      git clone https://github.com/zsh-users/zsh-syntax-highlighting
      git clone https://github.com/zsh-users/zsh-autosuggestions
      mv zsh-autosuggestions .oh-my-zsh/plugins & mv zsh-syntax-highlighting .oh-my-zsh/plugins

      # installation preparation
      su - tbladmin
      sudo apt-get update
      sudo apt-get install git zsh tmux slapd ldap-utils aria2 gdebi-core zip

      # installation
      mkdir install && cd install
      aria2c -s 5 -x 5 https://downloads.tableau.com/esdalt/2022.1.1/tableau-server-2022-1-1_amd64.deb
      sudo gdebi -n tableau-server-2022-1-1_amd64.deb
      cd /opt/tableau/tableau_server/packages/scripts.20221.22.0415.114
      sudo ./initialize-tsm --accepteula

      # logs locations:
      # /var/opt/tableau/tableau_server/logs/app-install.log
      # /var/opt/tableau/tableau_server/data/tabsvc/logs/tabadmincontroller/control_tabadmincontroller_node1-0.log

  data-platform:emr:
    ebsRootVolumeSize: 30
    scaleDownBehavior: TERMINATE_AT_TASK_COMPLETION 
    releaseLabel: emr-6.6.0
    osReleaseLabel: 2.0.20220406.1
    instanceGroups:
      - InstanceCount: 1 
        EbsConfiguration:
          EbsBlockDeviceConfigs:
            - VolumeSpecification:
                SizeInGB: 32
                VolumeType: gp2
              VolumesPerInstance: 1 
          EbsOptimized: true,
        InstanceGroupType: TASK
        InstanceType: m6g.xlarge
        Name: Task - 3
      - InstanceCount: 3 
        EbsConfiguration:
          EbsBlockDeviceConfigs:
            - VolumeSpecification:
                SizeInGB: 32
                VolumeType: gp2
              VolumesPerInstance: 2 
          EbsOptimized: true,
        InstanceGroupType: MASTER
        InstanceType: m5.xlarge 
        Name: Master - 1
      - InstanceCount: 1 
        EbsConfiguration:
          EbsBlockDeviceConfigs:
            - VolumeSpecification:
                SizeInGB: 32
                VolumeType: gp2
              VolumesPerInstance: 2 
          EbsOptimized: true,
        InstanceGroupType: TASK
        InstanceType: m6g.xlarge 
        Name: Core - 2
  data-platform:hivePassword:
    secure: AAABANLkxlhsXpRA3WSkfWW8krtaxBuHG1hThTno3a5DnJ1RKSedMLX5V4eJ6VA=
  data-platform:masterPassword:
    secure: AAABAHcJ6MXWmIPoczL9VIyz/TBUFaUHIVWorquadJSzc4Ubwys3PED3U6x2tCI=
  data-platform:rds:
    engine: aurora-mysql
    engineVersion: 5.7.mysql_aurora.2.10.2
    hiveUsername: hive
    iamDatabaseAuthenticationEnabled: true
    instanceClass: db.t3.small
    masterUsername: root
    port: 3306
  data-platform:vpc:
    numberOfAvailabilityZones: 2
    numberOfNatGateways: 1
  data-platform:timestamp:
    enable: false
